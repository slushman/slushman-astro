---
import BaseLayout from 'layout:BaseLayout';
import Bio from 'component:Bio';
import ProjectExcerpt from 'component:ProjectExcerpt';
import { SiteMeta } from '../siteMeta';
import { getCollection } from 'astro:content';
import LatestPosts from 'component:LatestPosts';

const { url } = Astro.request;

const posts = await getCollection('blog', ({ data }) => data.draft !== true);

const projects = await getCollection('project');
---

<BaseLayout description={SiteMeta.description} permalink={url} showSkip={false} title={SiteMeta.title}>
	<Bio />
  <div>
    <h2 class="m-0 p-6">Featured Projects</h2>
    <div class="grid sm:gap-2 sm:p-2 sm:grid-cols-post-list mb-8">
      {projects.map(({ data, slug }) => (
        <ProjectExcerpt description={data.description} name={data.name} slug={slug} />
      ))}
    </div>
  </div>
  <LatestPosts cta="Latest blog posts" />
  <section class="blue-section flex justify-center">
    <a href="/posts">Read other blog posts</a>
  </section>
</BaseLayout>
